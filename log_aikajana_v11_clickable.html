<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Logaritminen Aikajana v11 – Laattatapahtumat</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      font-family: sans-serif;
      background: #f5f5f5;
      overflow: hidden;
    }

    svg {
      width: 100%;
      height: 100%;
      display: block;
    }

    .event-label {
      font-size: 12px;
      fill: #000;
      pointer-events: none;
    }

    .card {
      fill-opacity: 0.2;
      stroke: #999;
      stroke-width: 1;
      rx: 10;
      ry: 10;
    }

    .card-label {
      font-size: 14px;
      fill: #333;
      font-weight: bold;
    }
  
    .inactive {
      filter: blur(2px);
    }

    .active {
      filter: none;
    }
    </style>

</head>
<body>
  <svg id="timeline"></svg>
  <script>
    const svg = d3.select("#timeline");
    const width = window.innerWidth;
    const height = window.innerHeight;
    const margin = { top: 20, left: 50 };
    const contentHeight = height - margin.top - 20;

    const yScale = d3.scaleLog().domain([1e0, 1e20]).range([contentHeight, 0]);

    const categoryColors = {
      kosmos: "#a0c4ff",
      elämä: "#b9fbc0",
      ihmiskunta: "#ffc6ff",
      kulttuuri: "#ffd6a5",
      teknologia: "#fdffb6"
    };

    
    const events = [
      { label: "Alkuräjähdys", year: "13.8 mrd v", log: 17.64, category: "kosmos" },
      { label: "Elämän synty", year: "3.8 mrd v", log: 17.08, category: "elämä" },
      { label: "Dinosaurukset kuolevat", year: "66 milj. v", log: 15.82, category: "elämä" },
      { label: "Homo sapiens", year: "300 000 v", log: 12.98, category: "ihmiskunta" },
      { label: "Antiikin Kreikka", year: "2500 v", log: 10.9, category: "kulttuuri" },
      { label: "Moderni tiede", year: "400 v", log: 10.6, category: "teknologia" }
    ];

    const xSpacing = width * 0.05;
    const cards = [

      { category: "kosmos", logStart: 14.6, logDuration: 5, xOffset: 0 },
      { category: "elämä", logStart: 13.6, logDuration: 5, xOffset: 80 },
      { category: "ihmiskunta", logStart: 1.8, logDuration: 13, xOffset: 160 },
      { category: "kulttuuri", logStart: 5.8, logDuration: 7, xOffset: 240 },
      { category: "teknologia", logStart: 2.8, logDuration: 9, xOffset: 320 }
    ];

    cards.forEach((d, i) => {
      const yTop = yScale(Math.pow(10, d.logStart + d.logDuration));
      const yBottom = yScale(Math.pow(10, d.logStart));
      const height = yBottom - yTop;

      
    const g = svg.append("g")
      .attr("class", "card-group inactive")
      .on("click", function () {
        d3.selectAll(".card-group").classed("active", false).classed("inactive", true);
        d3.select(this).classed("active", true).classed("inactive", false);
        this.parentNode.appendChild(this); // bring to front
      })

        .attr("transform", `translate(${margin.left + i * xSpacing}, 0)`);

      g.append("rect")
        .attr("class", "card")
        .attr("x", 0)
        .attr("y", yTop)
        .attr("width", width * 0.4)
        .attr("height", height)
        .attr("fill", categoryColors[d.category]);

      
      g.selectAll(".event")
        .data(events.filter(e => e.category === d.category))
        .enter()
        .append("text")
        .attr("class", "event-label")
        .attr("x", 20)
        .attr("y", e => yScale(Math.pow(10, e.log)))
        .text(e => `${e.label} (${e.year})`);

      g.append("text")

        .attr("class", "card-label")
        .attr("x", 10)
        .attr("y", yTop + 20)
        .text(d.category);
    });
  </script>
</body>
</html>